\section{Compression\label{compress}}
Compression was used to reduce the disk space needed
to store different versions of web pages.  The Zstandard ({\tt zstd}) package from Facebook \cite{zstd} was chosen as a tradeoff
between read/write speed and compression ratio.  This tradeoff
was a significantly easier choice than the one made by
\cite{page1998}, when Zstandard was not an option.  Cursory
comparisons between {\tt zstd} and other compression options
(both faster and more space-efficient) revealed that the library
was among the fastest, and yet its compression ratio was second
only to {\tt xz}.

\citeA{page1998} write that they compress each {\tt HTML} file, but an
alternative approach was taken in this project.  News sites are
subject to much larger amounts of change than the general web.
Large news sources such as {\it The New York Times} often release
hundreds of articles per day, and each article published will
usually appear on a homepage or section page at least once.
This causes webpages to move from one state to the next, with
small differences between neighbouring states, and large
differences between distant states (i.e. today's front page
versus last year's front page).  For this reason, \nr{} doesn't compress each individually fetched
{\tt HTML} file, but instead maintains one archive per resource, and
many versions per archive.

\begin{figure}
    \centering
    \Tree [.https://www.nytimes.com/news/2019/01/01/big-news.html
    	[.2020-01-01
    	    raw.html headers.txt raw.txt tokens.txt
    	]
    	[.2020-01-02
    	    raw.html
    	    headers.txt
    	]
    ]
    \caption{An example of what a resource archive's hierarchical structure.}
    \label{archive}
\end{figure}

Figure \ref{archive} illustrates the archiving format used to
store the corpus of resource versions.  In reality, the number
of formats is much larger than those shown in the hierarchical
diagram.

\begin{figure}
\begin{nodeC}
	\item{https://www.nytimes.com/news/2019/01/01/big-news.html}
	\item{(ywwmgz6zwg8vnp02pe.tzst)}
	\begin{nodeC}
		\item{1596573378626\_link-hits.bin}
		\item{1596573378626\_min-tokens.txt}
		\item{1596573378626\_bol.bin}
		\item{1596573378626\_rbin-botg.bin}
		\item{1596573378626\_bow.bin}
		\item{1596573378626\_ndoc-vec.bin}
		\item{1596573378626\_doc-vec.bin}
		\item{1596573378626\_raw-words.txt}
		\item{1596573378626\_bin-botg.bin}
		\item{1596573378626\_rbobg.bin}
		\item{1596573378626\_rbow.bin}
		\item{1596573378626\_raw-links.txt}
		\item{1596573378626\_rbosg.bin}
		\item{1596573378626\_bin-bol.bin}
		\item{1596573378626\_headers.txt}
		\item{1596573378626\_rbotg.bin}
		\item{1596573378626\_bin-bosg.bin}
		\item{1596573378626\_bin-bow.bin}
		\item{1596573378626\_raw.html}
		\item{1596573378626\_word-hits.bin}
		\item{1596573378626\_rbin-bobg.bin}
		\item{1596573378626\_rbin-bow.bin}
		\item{1596573378626\_tokens.txt}
		\item{1596573378626\_bobg.bin}
		\item{1596573378626\_bosg.bin}
		\item{1596573378626\_rbin-bosg.bin}
		\item{1596573378626\_bin-bobg.bin}
		\item{1596573378626\_sub-docs.txt}
		\item{1596573378626\_anchor-paths.txt}
		\item{1596573378626\_botg.bin}
	\end{nodeC}
\end{nodeC}
\caption{A realistic portrayal of a resource's archive.}
\label{real-arc}
\end{figure}

Figure \ref{real-arc} is a more realistic portrayal of a resource's
archive.  The archive is placed at a location resembling the
URL's ID (Section \ref{hashing}).  Under each archive, there is
a file named prefixed with the timestamp of the version it
represents, and suffixed with the unique name of a version
format.  The different formats are explained in more detail in
Section \ref{repr}.