import { WordVector } from "types/db-objects/WordVector"

test("vector parsing", () => {
    const s = "the 0.0120 -0.0268 0.1121 0.0277 0.0046 0.0338 0.1396 0.0112 -0.0631 0.0630 0.0315 0.0135 0.0028 0.0145 -0.0233 -0.0001 -0.0100 0.0161 -0.0915 0.2161 0.1492 -0.0080 0.0027 0.0014 -0.0194 -0.0071 -0.1985 -0.0052 -0.0087 0.0071 -0.0058 0.0374 0.0041 -0.0014 -0.0344 0.0084 -0.0064 -0.0255 -0.0164 0.0063 -0.0770 -0.2474 -0.0152 -0.0103 0.0446 0.0823 0.0314 -0.0163 0.0748 0.0186 0.0002 -0.0091 -0.0039 0.0110 -0.1585 -0.0065 0.1579 0.0313 0.2417 -0.0011 0.0023 0.0633 -0.0794 -0.0042 -0.0245 -0.0084 0.0172 -0.1142 -0.0102 0.0266 0.0107 -0.0213 0.0241 0.0269 -0.0057 -0.0005 -0.0187 -0.0189 0.0416 0.0194 -0.0106 -0.0279 -0.1751 0.0110 0.0023 0.0173 -0.0258 0.0249 0.0833 -0.0102 -0.0005 0.0171 0.0427 0.1354 0.0042 0.2789 -0.0311 0.0131 0.0069 0.0220 -0.0192 -0.0181 -0.0155 -0.0164 0.0419 -0.0036 -0.0147 0.0027 0.1047 -0.0110 -0.0571 -0.0017 0.0085 0.0854 0.0037 -0.0058 -0.0498 -0.0358 -0.0206 -0.3800 0.0183 0.0221 -0.0042 -0.0080 -0.0125 0.0002 0.0162 0.0362 -0.0182 -0.2271 0.0054 0.0021 -0.0553 -0.0546 -0.0022 0.0256 0.0047 0.0025 -0.0487 -0.0447 0.0142 -0.0144 0.2139 0.0057 -0.0786 0.0012 0.0218 -0.0062 -0.0154 -0.0151 -0.0075 -0.1063 -0.0479 0.0042 0.0235 -0.0068 -0.3213 -0.0563 0.0981 0.0032 0.0313 0.1816 -0.0491 -0.0083 0.0201 -0.0884 0.0027 -0.0065 -0.0030 0.0288 -0.0086 0.0172 -0.0105 -0.0233 0.0396 -0.0039 -0.0310 -0.0061 -0.0316 -0.0121 -0.0372 0.0164 0.0086 -0.0514 -0.1892 -0.0155 0.0107 0.0206 -0.0124 0.0032 0.0389 -0.0106 0.1121 0.0001 -0.0176 0.0038 0.0183 -0.0293 0.0150 -0.0245 -0.2179 0.0037 -0.0056 0.0066 0.0323 0.0633 0.0006 0.0153 -0.0106 -0.0334 -0.2179 -0.0117 0.0763 -0.0493 -0.0015 -0.0118 -0.0012 0.0020 -0.0416 0.0085 -0.0051 -0.0067 -0.0350 -0.0103 0.1299 0.0276 0.0383 0.2825 0.0157 -0.0359 -0.0775 -0.0430 -0.0554 -0.0097 -0.0044 -0.0648 -0.0013 -0.0346 -0.0308 0.0115 -0.0472 0.0131 -0.0136 -0.0010 -0.0069 0.0328 0.0233 -0.0677 -0.0048 -0.0133 0.2177 -0.0219 0.0118 0.0438 -0.0364 -0.0759 -0.0199 -0.0149 0.0075 0.0085 0.0255 -0.0065 0.0103 -0.0201 -0.0186 -0.0040 0.0107 0.0032 -0.0464 0.0227 0.0249 0.0114 -0.0169 0.0058 0.0145 -0.0255 -0.0306 0.0052 -0.0318 0.0210 -0.0202 0.0057 0.0264 0.0272 -0.0053 -0.0075 -0.0118 -0.1180 -0.0132 -0.0320 -0.0516 0.0033 -0.3371 0.0092 -0.0273 0.0900 0.0581 0.0093 -0.0337 -0.0091";
    const vector = WordVector.fromString(s, null).vector.value as Buffer;
    const all = [];
    for (let offset = 0; offset < vector.length; offset += 2) {
        let f: number | string = WordVector.floatFromBytes(vector, offset).float;
        if (f < 0) f = f.toString().padEnd(7, "0");
        else f = f.toString().padEnd(6, "0");
        all.push(f);
    }
    expect("the " + all.join(" ")).toBe(s);
    const src = -0.0268;
    const dst = WordVector.floatToBytes(src).buffer;
    const actual = WordVector.floatFromBytes(dst);
    console.log(src, actual);
});